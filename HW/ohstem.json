{"mode":"block","xmlText":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\":CbUwZWJD~,ILp#-ppO2\">distance</variable><variable id=\"v4:Bm:@uw|~MbwHkce9Y\">fan</variable></variables><block type=\"yolobit_basic_forever\" id=\"w5Bl*-!,Ihc8X2tI)wP*\" x=\"113\" y=\"-238\"><statement name=\"ONSTART\"><block type=\"yolobit_basic_scroll_text\" id=\"N2*C/3[t%Aap6cVk~+)R\"><value name=\"message\"><shadow type=\"text\" id=\"/5QFOWxHcBdf/|%NVaVa\"><field name=\"TEXT\">hi</field></shadow></value><next><block type=\"yolobit_mqtt_connect_wifi\" id=\"8eL`|K/myhn9$$}BJ.Lf\"><value name=\"WIFI\"><shadow type=\"text\" id=\"WOZ,9wjih=;Z_F@`)l3^\"><field name=\"TEXT\">iPo</field></shadow></value><value name=\"PASSWORD\"><shadow type=\"text\" id=\"Nj|bYq8wqqU=+}tQT#MT\"><field name=\"TEXT\">69696969</field></shadow></value><next><block type=\"yolobit_mqtt_connect_default_servers\" id=\"lgD^=Hd}$rBa4056r`Nc\"><field name=\"SERVER\">mqtt.ohstem.vn</field><value name=\"USERNAME\"><shadow type=\"text\" id=\"hufOWU/W2$T-Bg9FQ(:r\"><field name=\"TEXT\">thinhdadn</field></shadow></value><value name=\"KEY\"><shadow type=\"text\" id=\"T_1hdMXvDQ0s{avCz?=T\"><field name=\"TEXT\">hehe</field></shadow></value><next><block type=\"aiot_ultrasonic_create\" id=\"VNKK(TWHc[~zA`rc/(/s\"><field name=\"TRG\">pin3</field><field name=\"ECH\">pin6</field><next><block type=\"variables_set\" id=\":Ozy(Y:J*?h@Z!p$V$L9\"><field name=\"VAR\" id=\":CbUwZWJD~,ILp#-ppO2\">distance</field><value name=\"VALUE\"><block type=\"math_number\" id=\"(NNwdLSl9L`-_K*5XRv`\"><field name=\"NUM\">0</field></block></value><next><block type=\"yolobit_mqtt_on_receive_message\" id=\"JkrI71+/?Hvs}`z|qnMP\"><field name=\"message\" id=\"v4:Bm:@uw|~MbwHkce9Y\">fan</field><value name=\"TOPIC\"><shadow type=\"text\" id=\"|_?ZnPH!E*[)W(kCG0#]\"><field name=\"TEXT\">V2</field></shadow></value><statement name=\"ACTION\"><block type=\"aiot_lcd1602_clear\" id=\":OQ#Ec,P:yJ~}-7m;5o2\"><next><block type=\"aiot_lcd1602_display\" id=\"Gz)Gn,y[mtjBYbbq*FMZ\"><value name=\"string\"><shadow type=\"text\" id=\"1,DGa!_/yJFR3O(S7~]-\"><field name=\"TEXT\">Hello</field></shadow><block type=\"math_tonum\" id=\"daH;GI~XZNnN(Z6-ko,}\"><value name=\"A\"><block type=\"variables_get\" id=\"[_fL=6pf:zBvr38_sB@3\"><field name=\"VAR\" id=\"v4:Bm:@uw|~MbwHkce9Y\">fan</field></block></value></block></value><value name=\"X\"><shadow type=\"math_number\" id=\"^,~F|Yc%sYh|a6lK[,!O\"><field name=\"NUM\">1</field></shadow></value><value name=\"Y\"><shadow type=\"math_number\" id=\"/TD5A])PLZ_{Mx13u)se\"><field name=\"NUM\">0</field></shadow></value></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></statement><statement name=\"FOREVER\"><block type=\"yolobit_mqtt_check_message\" id=\"EK9+}o:]fjm{=KK`]Lb+\"><next><block type=\"yolobit_events_run\" id=\"Hni~mwqcIk,V$%th5~Z2\"><next><block type=\"yolobit_basic_sleep\" id=\"`|KzfUPRnnw{sSS!#*9X\"><value name=\"duration\"><shadow type=\"math_number\" id=\")N)!e80)5%GZ/.kG,*83\"><field name=\"NUM\">100</field></shadow></value></block></next></block></next></block></statement></block><block type=\"yolobit_events_timer\" id=\"pDUAxWzB{Nv!4%3Me|-i\" x=\"-38\" y=\"237\"><value name=\"INTERVAL\"><shadow type=\"math_number\" id=\"(y}8k?{|:#|7x6j;G1sk\"><field name=\"NUM\">1</field></shadow></value><statement name=\"ACTION\"><block type=\"aiot_lcd1602_clear\" id=\"n+C.FG2r.LorGoai17{T\"><next><block type=\"aiot_lcd1602_display\" id=\"sZL7XFuXck}?V!)v2Vx[\"><value name=\"string\"><shadow type=\"text\" id=\"1,DGa!_/yJFR3O(S7~]-\"><field name=\"TEXT\">Hello</field></shadow><block type=\"variables_get\" id=\"L3iaI;g_i7[)nFq_9P)+\"><field name=\"VAR\" id=\":CbUwZWJD~,ILp#-ppO2\">distance</field></block></value><value name=\"X\"><shadow type=\"math_number\" id=\"zMVfelNO)`eKaXN36G?5\"><field name=\"NUM\">0</field></shadow></value><value name=\"Y\"><shadow type=\"math_number\" id=\"O[^W^y2/eXjthb#biyl[\"><field name=\"NUM\">1</field></shadow></value></block></next></block></statement></block><block type=\"controls_if\" id=\"|UsG-`YA2U_+_`VuBSa:\" x=\"637\" y=\"213\"><mutation else=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_compare\" id=\"e,hYfPxLq49%4y%MxN~j\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\"~`E5l^_0sD=hhp5w@O*}\"><field name=\"VAR\" id=\"v4:Bm:@uw|~MbwHkce9Y\">fan</field></block></value><value name=\"B\"><block type=\"math_number\" id=\"H0EUj;UQZ=0=?4?uIIX/\"><field name=\"NUM\">1</field></block></value></block></value><next><block type=\"aiot_minifan\" id=\"20c?uc[rsIB1)N:+a=C[\"><field name=\"NAME\">pin10</field><value name=\"percent\"><shadow type=\"math_number\" id=\"q1_*wVdzl;0sIa6X*CI[\"><field name=\"NUM\">70</field></shadow></value><next><block type=\"aiot_minifan\" id=\"p}z%#T93vFqnM@BYR0^a\"><field name=\"NAME\">pin10</field><value name=\"percent\"><shadow type=\"math_number\" id=\"R]vIBDBbzxrHE[QJ?3wN\"><field name=\"NUM\">0</field></shadow></value></block></next></block></next></block><block type=\"yolobit_events_timer\" id=\"zS?wm7{k]q`kp;w=^1Ww\" x=\"-38\" y=\"412\"><value name=\"INTERVAL\"><shadow type=\"math_number\" id=\"twbJ}mi6Vue]vU~eQlqB\"><field name=\"NUM\">1</field></shadow></value><statement name=\"ACTION\"><block type=\"variables_set\" id=\"9S1dtZ^5JSLY}yhML?zS\"><field name=\"VAR\" id=\":CbUwZWJD~,ILp#-ppO2\">distance</field><value name=\"VALUE\"><block type=\"aiot_ultrasonic_read\" id=\"2iAyB[LRqXb--`_mdAbU\"><field name=\"TYPE\">CM</field></block></value><next><block type=\"yolobit_mqtt_publish\" id=\"S~ZdVLo(/Qtf`fI|Omh9\"><value name=\"MESSAGE\"><shadow type=\"text\" id=\"|QA@hSJxZ/nuH#^rrD~5\"><field name=\"TEXT\">Hello</field></shadow><block type=\"variables_get\" id=\"$r~(Zd[iB_x]g_GPbAQ2\"><field name=\"VAR\" id=\":CbUwZWJD~,ILp#-ppO2\">distance</field></block></value><value name=\"TOPIC\"><shadow type=\"text\" id=\"^V!Q#NJVb--!^0*II-z8\"><field name=\"TEXT\">V1</field></shadow></value><next><block type=\"controls_if\" id=\"A-5zOF6aAf;3F_QyoR7I\"><mutation else=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_compare\" id=\"Dl?AQWun=;E*dwPJd;8/\"><field name=\"OP\">LT</field><value name=\"A\"><block type=\"variables_get\" id=\"!#,GbxDUM3g:gq?(^r00\"><field name=\"VAR\" id=\":CbUwZWJD~,ILp#-ppO2\">distance</field></block></value><value name=\"B\"><block type=\"math_number\" id=\"~?h1-H+PH-HgcdFh.U1Y\"><field name=\"NUM\">10</field></block></value></block></value><statement name=\"DO0\"><block type=\"aiot_led_tiny_set_all\" id=\"pI%x^$UKVv(1KxQYCbfg\"><field name=\"port\">pin0</field><field name=\"option\">0</field><value name=\"COLOR\"><shadow type=\"colour_picker\" id=\"ehTmasY]qUu1?:92.f=D\"><field name=\"COLOUR\">#ff0000</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"aiot_led_tiny_set_all\" id=\"$ZrT;90Oo_I(k0;4p^%D\"><field name=\"port\">pin0</field><field name=\"option\">0</field><value name=\"COLOR\"><shadow type=\"colour_picker\" id=\"`gZg2v^3+^VX.fK1Cc$f\"><field name=\"COLOUR\">#000000</field></shadow></value></block></statement></block></next></block></next></block></statement></block></xml>","python":"from yolobit import *\nbutton_a.on_pressed = None\nbutton_b.on_pressed = None\nbutton_a.on_pressed_ab = button_b.on_pressed_ab = -1\nfrom mqtt import *\nfrom aiot_hcsr04 import HCSR04\nfrom aiot_lcd1602 import LCD1602\nfrom event_manager import *\nimport time\nfrom aiot_rgbled import RGBLed\n\naiot_lcd1602 = LCD1602()\n\ndef on_mqtt_message_receive_callback__V2_(fan):\n  global distance\n  aiot_lcd1602.clear()\n  aiot_lcd1602.move_to(1, 0)\n  aiot_lcd1602.putstr((int(fan)))\n\nevent_manager.reset()\n\ndef on_event_timer_callback_p_D_U_A_x():\n  global distance, fan\n  aiot_lcd1602.clear()\n  aiot_lcd1602.move_to(0, 1)\n  aiot_lcd1602.putstr(distance)\n\nevent_manager.add_timer_event(1000, on_event_timer_callback_p_D_U_A_x)\n\ntiny_rgb = RGBLed(pin0.pin, 4)\n\ndef on_event_timer_callback_z_S_w_m_k():\n  global distance, fan\n  distance = aiot_ultrasonic.distance_cm()\n  mqtt.publish('V1', distance)\n  if distance < 10:\n    tiny_rgb.show(0, hex_to_rgb('#ff0000'))\n  else:\n    tiny_rgb.show(0, hex_to_rgb('#000000'))\n\nevent_manager.add_timer_event(1000, on_event_timer_callback_z_S_w_m_k)\n\nif True:\n  display.scroll('hi')\n  mqtt.connect_wifi('iPo', '69696969')\n  mqtt.connect_broker(server='mqtt.ohstem.vn', port=1883, username='thinhdadn', password='hehe')\n  aiot_ultrasonic = HCSR04(trigger_pin=pin3.pin, echo_pin=pin6.pin)\n  distance = 0\n  mqtt.on_receive_message('V2', on_mqtt_message_receive_callback__V2_)\n\nwhile True:\n  mqtt.check_message()\n  event_manager.run()\n  time.sleep_ms(100)\n\n\nif fan == 1:\n  pass\nelse:\n  pass\npin10.write_analog(round(translate(70, 0, 100, 0, 1023)))\npin10.write_analog(round(translate(0, 0, 100, 0, 1023)))\n","name":"tess1","extensions":[{"id":"yolobit-AITT-VN-yolobit_extension_events","src":"https://github.com/AITT-VN/yolobit_extension_events","name":"SỰ KIỆN","description":"Mục mở rộng hỗ trợ sử dụng sự kiện trong chương trình"},{"id":"yolobit-AITT-VN-yolobit_extension_mqtt","src":"https://github.com/AITT-VN/yolobit_extension_mqtt","name":"MQTT","description":"Mục mở rộng hỗ trợ giao tiếp MQTT cho ứng dụng IoT"},{"id":"yolobit-AITT-VN-yolobit_extension_aiot","src":"https://github.com/AITT-VN/yolobit_extension_aiot","name":"AIOT Kit","description":"Mục mở rộng dành cho bộ kit AIoT"}],"device":"yolobit"}